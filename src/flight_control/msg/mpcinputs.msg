float32[] x_cur
float32[] x_ref
float32[] u_past